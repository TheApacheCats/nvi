#	$Id: README,v 5.6 1993/02/16 11:52:23 bostic Exp $ (Berkeley) $Date: 1993/02/16 11:52:23 $

An ALPHA version of the new ex/vi, which will be distributed as nvi in
4.4BSD, can be retrieved by anonymous ftp from vangogh.cs.berkeley.edu,
from hidden/nvi.tar.Z.

Please note that this is ALPHA software, and is nowhere near ready for
prime time.

This software is derived from software contributed to UC Berkeley by
Steve Kirkendall, the author of the vi clone elvis.  Without his work,
this work would have been far more difficult.

Nvi is being distributed for development and review only -- please don't
redistribute it to anyone without talking to me first!

	Keith Bostic				bostic@cs.berkeley.edu
						510-642-8524

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

+ Comments:

This software is alpha software, at best.  I believe that almost all of
the necessary functionality for ex/vi is in it, but it's definitely not
ready for prime time.  My expectation is that it will be ready to go with
two or so months of bug-fixing.  Code fixes are, of course, very much
appreciated, but if you don't have time, please send me as much
information as you can as to how to reproduce the bug, and I'll fix it
here.  In particular, the screen routines are nasty stuff, and you
probably don't want to mess with them.

Nvi is not yet 8-bit clean, although it only disallows NULLs.  This isn't
difficult to fix, and was deliberately left in during initial development.
Wide character support will be integrated at the same time that NULL
support is included.

The ex/vi recovery on system crash has not yet been implemented.  (This
isn't difficult, only requiring some extensions to the current logging
interface.)

+ Porting information:

The directory PORT has a old-style Makefile which builds the entire nvi
distribution.  See it and the file PORT/README for more information.

+ A quick tour:

The main directory, nvi, contains some source files for various pieces
of code that are shared by both ex and vi, mostly logging code or code
translating line numbers into requests to the dbopen(3) database code.
It also has the code for adding, deleting, and changing "records" in
the underlying database.

The nvi/vi directory is the vi source code.

The nvi/ex directory is the ex source code.  Lots of this code is used by
vi, however.  Generally, if the functionality is shared by both ex and
vi, it's in nvi/ex, if it's vi only, it's in nvi/vi.  Files are generally
named by the command(s) they support, but occasionally with a name that
describes their functionality.

+ Data structures:

There are a few major data structures:

EXF	In nvi/exf.h.  This structure describes a file, and is the
	cookie that is passed around or used by pretty much everything.
	In addition, all of the screen information is included inside
	this structure, although that is expected to change in the
	near future.

TEXT	In nvi/cut.h.  This structure describes a portion of a line,
	and is used by the input routines and as the line part of a
	cut buffer.

CB	In nvi/cut.h.	A cut buffer.

IB	In nvi/cut.h.	An input buffer, which is only used by the
	input routines in the vi code.

MARK	In nvi/mark.h.  A cursor position, consisting of a line number
	and a column number.

EXCMDARG
	In nvi/ex/excmd.h.stub.  The structure that gets passed around
	to the functions that implement the ex commands.  (The main
	ex command loop (see nvi/ex/ex.c) builds this up and then passes
	it to the ex functions.)

VICMDARG
	In nvi/vi/vcmd.h.  The structure that gets passed around to the
	functions that implement the vi commands.  (The main vi command
	loop (see nvi/vi/vi.c) builds this up and then passes it to the
	vi functions.)
